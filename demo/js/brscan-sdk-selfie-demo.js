let config;async function startDemo(e){e.staticDependenciesPath=config.staticDependenciesPath,e.sdkVersion,document.documentElement.style.setProperty("--cor-primary",config.corPrimary),document.documentElement.style.setProperty("--cor-textCorpo",config.corTextCorpo),document.documentElement.style.setProperty("--cor-textTitle",config.corTextTitle),document.documentElement.style.setProperty("--cor-textButton",config.corTextButton),document.documentElement.style.setProperty("--font-family",config.fontFamily),e.proxyUrl=config.proxyUrl,e.loadingSpinnerColor=config.corPrimary,e.wizzard=config.wizzard,e.playCaptureSound=config.playCaptureSound,e.desabilitaCapturaDesktop=config.desabilitaCapturaDesktop,e.captureTimeout=config.timeoutCaptura,e.requestsTimeout=config.timeoutRequests,e.cameraTraseira=config.cameraTraseira,e.numMaxTentativas=config.maxTentativas,e.traceId="abcteste124";let t=null;void 0!==window.Alwm&&(t={userId:"12345678989",event:await Alwm.collect({metadata:{eventName:"liveness"},timeout:1e4})}),e.iniciaSelfie(document.getElementById("selfie"),((e,t)=>{}),t).then((e=>{document.body.style.overflow="auto",hideLoginContainer(),showResultContainer(),document.getElementById("imgA").src=e.selfie,document.getElementById("jsonResult").innerHTML=`selfieValida: ${e.selfieValida}`})).catch((e=>{e.id,e.desc,hideLoginContainer(),showResultContainer(),clearCookies(),document.getElementById("imgA").src="",document.getElementById("jsonResult").innerHTML=JSON.stringify(e)}))}function clearCookies(){localStorage.clear(),document.cookie.split(";").forEach((function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}))}function hideLoginContainer(){document.getElementById("login").style.display="none"}function hideResultContainer(){document.getElementById("sdkResult").style.display="none"}function showLoginContainer(){document.getElementById("login").style.display="block"}function showResultContainer(){document.getElementById("sdkResult").style.display="block"}function getUserTokenURL(e){return`${BASE_URL}/security/iam/v1/user-identities/login?clientId=${e}`}function getClientTokenURL(){return`${BASE_URL}/security/iam/v1/client-identities/login`}function disableAllButtons(){document.querySelectorAll("button").forEach((e=>{e.disabled=!0}))}function enableAllButtons(){document.querySelectorAll("button").forEach((e=>{e.disabled=!1}))}function setCookie(e,t){const n=new Date;n.setTime(n.getTime()+36e5);const o="expires="+n.toUTCString();document.cookie=e+"="+t+";"+o+";path=/"}function getCookie(e){const t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let o=n[e];for(;" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}function checkCookieToStart(){const e=getCookie("bearerToken");if(hideResultContainer(),e){hideLoginContainer(),startDemo(new window.BrScanSDKSelfie.Selfie(e,""))}else showLoginContainer()}async function getToken(e,t,n){return new Promise((async(o,i)=>{let a=new Headers;a.append("Authorization","Basic "+btoa(t+":"+n)),a.append("Content-Type","application/json");let l=await fetch(e,{method:"POST",headers:a});try{let e=await l.json();o(e.accessToken)}catch(e){i({id:"INVALID_AUTHENTICATION",desc:"Erro ao gerar token. Por favor, verifique as credenciais e tente novamente."})}}))}document.getElementById("legacyButton").addEventListener("click",(function(){var e=document.getElementById("legacyKey").value,t=document.getElementById("error-message");""===e?(t.style.display="block",t.textContent="Por favor, preencha o campo com a chave legada"):(t.style.display="none",t.textContent="",(async()=>{startDemo(new window.BrScanSDKSelfie.Selfie(e))})())})),document.getElementById("tryAgain").addEventListener("click",(function(){checkCookieToStart()})),document.getElementById("loginButton").addEventListener("click",(function(){var e=document.getElementById("clientId").value,t=document.getElementById("username").value,n=document.getElementById("password").value,o=document.getElementById("error-message");""===e||""===n?(o.style.display="block",o.textContent="Por favor, preencha os campos de clientId, user e senha."):""===t?(disableAllButtons(),o.style.display="none",o.textContent="",(async()=>{await getToken(getClientTokenURL(),e,n).then((e=>{if(enableAllButtons(),e){setCookie("bearerToken",e),o.style.display="none",startDemo(new window.BrScanSDKSelfie.Selfie(e,""))}else o.style.display="block",o.textContent="Erro na autenticação"})).catch((e=>{enableAllButtons(),o.style.display="block",o.textContent=e}))})()):(disableAllButtons(),o.style.display="none",o.textContent="",(async()=>{await getToken(getUserTokenURL(e),t,n).then((e=>{if(enableAllButtons(),e){setCookie("bearerToken",e),o.style.display="none",startDemo(new window.BrScanSDKSelfie.Selfie(e,""))}else o.style.display="block",o.textContent="Erro na autenticação"})).catch((async e=>{enableAllButtons(),o.style.display="block",o.textContent=e}))})())})),document.addEventListener("DOMContentLoaded",(function(e){config=loadConfig();const t=document.createElement("script");switch(t.type="text/javascript",SERASA_SDK_ENV,SERASA_SDK_ENV){case"dev":t.src="../brscan-dev-sdk-selfie.min.js";break;case"uat":t.src="../brscan-uat-sdk-selfie.min.js";break;case"prod":t.src="../brscan-sdk-selfie.min.js";break;default:alert(`Ambiente ${SERASA_SDK_ENV} não encontrado`)}t.onload=function(){checkCookieToStart()},window.document.body.appendChild(t)}));